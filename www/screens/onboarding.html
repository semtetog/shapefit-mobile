<div class="app-container">
    <header class="header-nav">
        <div class="header-left">
            <button type="button" class="back-button" id="back-btn">
                <i class="fa-solid fa-arrow-left"></i>
            </button>
            <div class="step-indicator-text" id="step-indicator-text">Passo 1 de 16</div>
        </div>
        <button type="button" class="btn-secondary" style="display:none;" id="skip-btn">Pular</button>
    </header>

    <div class="progress-bar-wrapper">
        <div class="progress-bar-track">
            <div class="progress-bar-fill" id="progress-bar-fill"></div>
        </div>
    </div>

    <form id="onboarding-form" novalidate>
        <input type="hidden" name="custom_activities" id="custom-activities-hidden-input">

        <!-- STEP 1: Objetivo -->
        <div class="form-step active" data-step="1" data-step-id="objective">
            <div class="step-content">
                <div class="step-main">
                    <div>
                        <h1 class="page-title">Qual é o seu objetivo principal?</h1>
                        <p class="page-subtitle">Isso vai definir a base do seu plano alimentar.</p>
                    </div>
                    <div class="selectable-options">
                        <input type="radio" id="obj1" name="objective" value="lose_fat" required>
                        <label for="obj1" class="option-card"><span>Emagrecimento</span></label>

                        <input type="radio" id="obj2" name="objective" value="maintain_weight" required>
                        <label for="obj2" class="option-card"><span>Manutenção de peso</span></label>

                        <input type="radio" id="obj3" name="objective" value="gain_muscle" required>
                        <label for="obj3" class="option-card"><span>Ganho de massa muscular</span></label>
                    </div>
                </div>
                <div class="step-helper">Você poderá ajustar o objetivo depois com seu nutricionista.</div>
            </div>
        </div>

        <!-- STEP 2: Peso -->
        <div class="form-step" data-step="2" data-step-id="weight">
            <div class="step-content">
                <div class="step-main">
                    <div>
                        <h1 class="page-title">Vamos começar pelo seu peso</h1>
                        <p class="page-subtitle">Use o valor mais próximo possível da sua realidade hoje.</p>
                    </div>
                    <div class="form-control-wrapper">
                        <input type="text" name="weight_kg" id="weight-input" class="form-control" placeholder="Seu peso (kg)" required pattern="[0-9]+([,\.]?[0-9]{1,2})?">
                    </div>
                    <div id="weight-restriction-message" style="display: none; margin-top: 12px; padding: 12px; background: rgba(255, 107, 0, 0.1); border-radius: 8px; color: var(--accent-orange); font-size: 0.9rem;">
                        <i class="fa-solid fa-clock"></i> Você só pode ajustar o peso a cada 7 dias. Próximo ajuste em <strong id="days-remaining">0</strong> <span id="days-text">dias</span>.
                    </div>
                </div>
                <div class="step-helper">Se não souber exato, pode arredondar.</div>
            </div>
        </div>

        <!-- STEP 3: Altura -->
        <div class="form-step" data-step="3" data-step-id="height">
            <div class="step-content">
                <div class="step-main">
                    <div>
                        <h1 class="page-title">Agora, sua altura</h1>
                        <p class="page-subtitle">Essa informação é essencial para os cálculos.</p>
                    </div>
                    <div class="form-control-wrapper">
                        <input type="number" name="height_cm" class="form-control" placeholder="Sua altura (cm)" required min="50" max="300">
                    </div>
                </div>
                <div class="step-helper">Exemplo: 165, 172, 183…</div>
            </div>
        </div>

        <!-- STEP 4: Tipos de exercício -->
        <div class="form-step" data-step="4" data-step-id="exercise_types">
            <div class="step-content">
                <div class="step-main">
                    <div>
                        <h1 class="page-title">Quais exercícios você pratica?</h1>
                        <p class="page-subtitle">Pode escolher mais de um.</p>
                    </div>

                    <div id="exercise-options-wrapper">
                        <div class="selectable-options-grid">
                            <input type="checkbox" id="ex1" name="exercise_types[]" value="Musculação">
                            <label for="ex1" class="option-card small"><span>Musculação</span></label>

                            <input type="checkbox" id="ex2" name="exercise_types[]" value="Corrida">
                            <label for="ex2" class="option-card small"><span>Corrida</span></label>

                            <input type="checkbox" id="ex3" name="exercise_types[]" value="Crossfit">
                            <label for="ex3" class="option-card small"><span>Crossfit</span></label>

                            <input type="checkbox" id="ex4" name="exercise_types[]" value="Natação">
                            <label for="ex4" class="option-card small"><span>Natação</span></label>

                            <input type="checkbox" id="ex5" name="exercise_types[]" value="Yoga">
                            <label for="ex5" class="option-card small"><span>Yoga</span></label>

                            <input type="checkbox" id="ex6" name="exercise_types[]" value="Futebol">
                            <label for="ex6" class="option-card small"><span>Futebol</span></label>

                            <button type="button" class="option-button small" id="other-activity-btn">
                                <span>Outro</span>
                            </button>

                            <input type="checkbox" id="ex-none" name="exercise_type_none">
                            <label for="ex-none" class="option-card small option-none"><span>Nenhum</span></label>
                        </div>
                    </div>
                </div>
                <div class="step-helper">Se você não pratica exercícios hoje, marque "Nenhum".</div>
            </div>
        </div>

        <!-- STEP 5: Frequência de treino (pula se marcar Nenhuma) -->
        <div class="form-step" data-step="5" data-step-id="exercise_frequency">
            <div class="step-content">
                <div class="step-main">
                    <div>
                        <h1 class="page-title">Com que frequência você treina?</h1>
                        <p class="page-subtitle">Conte apenas os dias em que você realmente se movimenta.</p>
                    </div>
                    <div class="selectable-options" id="frequency-wrapper">
                        <input type="radio" id="freq1" name="exercise_frequency" value="1_2x_week" required>
                        <label for="freq1" class="option-card small"><span>1 a 2 vezes por semana</span></label>

                        <input type="radio" id="freq2" name="exercise_frequency" value="3_4x_week" required>
                        <label for="freq2" class="option-card small"><span>3 a 4 vezes por semana</span></label>

                        <input type="radio" id="freq3" name="exercise_frequency" value="5_6x_week" required>
                        <label for="freq3" class="option-card small"><span>5 a 6 vezes por semana</span></label>

                        <input type="radio" id="freq4" name="exercise_frequency" value="6_7x_week" required>
                        <label for="freq4" class="option-card small"><span>6 a 7 vezes por semana</span></label>

                        <input type="radio" id="freq5" name="exercise_frequency" value="7plus_week" required>
                        <label for="freq5" class="option-card small"><span>Mais de 7 vezes por semana</span></label>
                    </div>
                </div>
                <div class="step-helper">Se você marcou "Nenhum" antes, essa etapa será pulada.</div>
            </div>
        </div>

        <!-- STEP 6: Água -->
        <div class="form-step" data-step="6" data-step-id="water">
            <div class="step-content">
                <div class="step-main">
                    <div>
                        <h1 class="page-title">Hidratação</h1>
                        <p class="page-subtitle">Quanto de água você toma por dia, em média?</p>
                    </div>
                    <div class="selectable-options">
                        <input type="radio" id="w1" name="water_intake_liters" value="_1l" required>
                        <label for="w1" class="option-card small"><span>Até 1 litro</span></label>

                        <input type="radio" id="w2" name="water_intake_liters" value="1_2l" required>
                        <label for="w2" class="option-card small"><span>De 1 a 2 litros</span></label>

                        <input type="radio" id="w3" name="water_intake_liters" value="2_3l" required>
                        <label for="w3" class="option-card small"><span>De 2 a 3 litros</span></label>

                        <input type="radio" id="w4" name="water_intake_liters" value="3plus_l" required>
                        <label for="w4" class="option-card small"><span>Mais de 3 litros</span></label>
                    </div>
                </div>
                <div class="step-helper">Inclua água pura, não conte refrigerantes ou sucos.</div>
            </div>
        </div>

        <!-- STEP 7: Hora que deita -->
        <div class="form-step" data-step="7" data-step-id="sleep_bed">
            <div class="step-content">
                <div class="step-main">
                    <div>
                        <h1 class="page-title">Seu horário de sono</h1>
                        <p class="page-subtitle">Em média, que horas você costuma deitar?</p>
                    </div>
                    <div>
                        <label class="input-label">Costumo deitar</label>
                        <div class="form-control-wrapper">
                            <input type="time" name="sleep_time_bed" class="form-control" required>
                        </div>
                    </div>
                </div>
                <div class="step-helper">Não precisa ser exato, apenas a rotina geral.</div>
            </div>
        </div>

        <!-- STEP 8: Hora que acorda -->
        <div class="form-step" data-step="8" data-step-id="sleep_wake">
            <div class="step-content">
                <div class="step-main">
                    <div>
                        <h1 class="page-title">E que horas você costuma acordar?</h1>
                        <p class="page-subtitle">Vamos entender melhor seu ritmo de sono.</p>
                    </div>
                    <div>
                        <label class="input-label">Costumo levantar</label>
                        <div class="form-control-wrapper">
                            <input type="time" name="sleep_time_wake" class="form-control" required>
                        </div>
                    </div>
                </div>
                <div class="step-helper">Se sua rotina muda, escolha o mais frequente.</div>
            </div>
        </div>

        <!-- STEP 9: Carne -->
        <div class="form-step" data-step="9" data-step-id="meat">
            <div class="step-content">
                <div class="step-main">
                    <div>
                        <h1 class="page-title">Consumo de carnes</h1>
                        <p class="page-subtitle">Você consome carnes (vermelha e branca)?</p>
                    </div>
                    <div class="selectable-options">
                        <input type="radio" id="meat_yes" name="meat_consumption" value="1" required>
                        <label for="meat_yes" class="option-card"><span>Sim, como carne</span></label>

                        <input type="radio" id="meat_no" name="meat_consumption" value="0" required>
                        <label for="meat_no" class="option-card"><span>Não, não consumo carnes</span></label>
                    </div>
                </div>
                <div class="step-helper">Se você marcar "Sim", vamos pular os tipos de vegetarianismo.</div>
            </div>
        </div>

        <!-- STEP 10: Tipo vegetariano (pula se come carne) -->
        <div class="form-step" data-step="10" data-step-id="vegetarian">
            <div class="step-content">
                <div class="step-main">
                    <div>
                        <h1 class="page-title">Entendido!</h1>
                        <p class="page-subtitle">Qual opção melhor descreve você hoje?</p>
                    </div>
                    <div class="selectable-options">
                        <input type="radio" id="veg1" name="vegetarian_type" value="strict_vegetarian" required>
                        <label for="veg1" class="option-card small"><span>Vegetariano estrito</span></label>

                        <input type="radio" id="veg2" name="vegetarian_type" value="ovolacto" required>
                        <label for="veg2" class="option-card small"><span>Ovolactovegetariano</span></label>

                        <input type="radio" id="veg3" name="vegetarian_type" value="vegan" required>
                        <label for="veg3" class="option-card small"><span>Vegano</span></label>

                        <input type="radio" id="veg4" name="vegetarian_type" value="not_like" required>
                        <label for="veg4" class="option-card small"><span>Apenas não gosto de carnes</span></label>
                    </div>
                </div>
                <div class="step-helper">Se você não come carne, isso ajuda a montar substituições adequadas.</div>
            </div>
        </div>

        <!-- STEP 11: Lactose -->
        <div class="form-step" data-step="11" data-step-id="lactose">
            <div class="step-content">
                <div class="step-main">
                    <div>
                        <h1 class="page-title">Intolerância à lactose</h1>
                        <p class="page-subtitle">Você tem intolerância à lactose?</p>
                    </div>
                    <div class="selectable-options">
                        <input type="radio" id="lac_yes" name="lactose_intolerance" value="1" required>
                        <label for="lac_yes" class="option-card"><span>Sim</span></label>

                        <input type="radio" id="lac_no" name="lactose_intolerance" value="0" required>
                        <label for="lac_no" class="option-card"><span>Não</span></label>
                    </div>
                </div>
                <div class="step-helper">Inclui desconfortos como gases, dores ou inchaço após laticínios.</div>
            </div>
        </div>

        <!-- STEP 12: Glúten -->
        <div class="form-step" data-step="12" data-step-id="gluten">
            <div class="step-content">
                <div class="step-main">
                    <div>
                        <h1 class="page-title">E quanto ao glúten?</h1>
                        <p class="page-subtitle">Você tem alguma restrição ao glúten?</p>
                    </div>
                    <div class="selectable-options">
                        <input type="radio" id="glu_yes" name="gluten_intolerance" value="1" required>
                        <label for="glu_yes" class="option-card"><span>Sim</span></label>

                        <input type="radio" id="glu_no" name="gluten_intolerance" value="0" required>
                        <label for="glu_no" class="option-card"><span>Não</span></label>
                    </div>
                </div>
                <div class="step-helper">Isso inclui doença celíaca, sensibilidade ou recomendação médica.</div>
            </div>
        </div>

        <!-- STEP 13: Localização -->
        <div class="form-step" data-step="13" data-step-id="location">
            <div class="step-content">
                <div class="step-main">
                    <div>
                        <h1 class="page-title">Onde você mora?</h1>
                        <p class="page-subtitle">Isso ajuda a adaptar sua realidade de alimentos.</p>
                    </div>
                    <div class="flex-row">
                        <div class="select-wrapper" style="flex: 0 0 90px;">
                            <select name="uf" id="uf-select" class="form-control" required>
                                <option value="" disabled selected>UF</option>
                            </select>
                        </div>
                        <div class="form-control-wrapper" style="flex-grow: 1;">
                            <input type="text" name="city" class="form-control" placeholder="Cidade" required>
                        </div>
                    </div>
                </div>
                <div class="step-helper">Exemplo: SP - São Paulo, RJ - Rio de Janeiro.</div>
            </div>
        </div>

        <!-- STEP 14: Telefone -->
        <div class="form-step" data-step-id="phone">
            <div class="step-content">
                <div class="step-main">
                    <div>
                        <h1 class="page-title">Seu WhatsApp</h1>
                        <p class="page-subtitle">Usaremos esse contato se o profissional precisar falar com você.</p>
                    </div>
                    <div class="flex-row">
                        <div class="form-control-wrapper" style="flex: 0 0 80px;">
                            <input type="tel" name="phone_ddd" class="form-control" placeholder="DDD" maxlength="2" required pattern="[0-9]*">
                        </div>
                        <div class="form-control-wrapper" style="flex-grow: 1;">
                            <input type="tel" name="phone_number" class="form-control" placeholder="Celular" maxlength="9" required pattern="[0-9]*">
                        </div>
                    </div>
                </div>
                <div class="step-helper">Apenas números, sem traços ou parênteses.</div>
            </div>
        </div>

        <!-- STEP 15: Data de nascimento + Gênero -->
        <div class="form-step" data-step-id="dob_gender">
            <div class="step-content">
                <div class="step-main">
                    <div>
                        <h1 class="page-title">Último passo!</h1>
                        <p class="page-subtitle">Complete seus dados para criar seu plano.</p>
                    </div>

                    <div>
                        <label class="input-label">Data de nascimento</label>
                        <div class="form-control-wrapper">
                            <input type="date" name="dob" class="form-control" required>
                        </div>
                    </div>

                    <div>
                        <label class="input-label">Com qual gênero você se identifica?</label>
                        <div class="select-wrapper">
                            <select name="gender" class="form-control" required>
                                <option value="" disabled selected>Selecione uma opção</option>
                                <option value="female">Mulher</option>
                                <option value="male">Homem</option>
                                <option value="other">Outro</option>
                                <option value="not_informed">Prefiro não informar</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="step-helper">Essas informações são importantes para cálculos e personalização.</div>
            </div>
        </div>

        <footer class="footer-nav">
            <button type="button" id="action-btn" class="btn-primary" disabled>Continuar</button>
            <button type="button" id="exit-btn" class="exit-button">Sair do questionário</button>
        </footer>
    </form>
</div>

<!-- MODAL ATIVIDADES CUSTOMIZADAS -->
<div class="modal-overlay" id="custom-activity-modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Adicionar atividade</h2>
            <button type="button" class="modal-close-btn" id="close-modal-icon">
                <i class="fa-solid fa-xmark"></i>
            </button>
        </div>
        
        <div class="modal-tags-container" id="custom-activities-list"></div>
        
        <div class="modal-input-section">
            <div class="form-control-wrapper">
                <input type="text" id="custom-activity-input" class="form-control" placeholder="Ex: Tênis de mesa">
            </div>
            <button type="button" id="add-activity-btn" class="modal-add-btn">
                <i class="fas fa-plus"></i>
            </button>
        </div>
        
        <div class="modal-footer">
            <button type="button" id="close-modal-btn" class="btn-primary">Concluir</button>
        </div>
    </div>
</div>
