<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover, shrink-to-fit=no">
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ShapeFIT">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="ShapeFIT">
    <meta name="theme-color" content="#000000">
    
    <link rel="manifest" href="/manifest.json">
    
    <title>ShapeFIT</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    
   
   
  

    <link rel="stylesheet" href="/assets/css/style.css">
    
    <style>
        /* === VIEW TRANSITIONS API (Login <-> Register) === */
        @view-transition {
            navigation: auto;
        }
        
        /* Logo transiciona suavemente de posição */
        ::view-transition-old(auth-logo),
        ::view-transition-new(auth-logo) {
            animation-duration: 0.35s;
            animation-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        /* Desabilitar animação padrão da logo - só mover */
        ::view-transition-old(auth-logo) {
            animation: none;
        }
        
        ::view-transition-new(auth-logo) {
            animation: none;
        }
        
        /* Root (fundo) não anima - evita o flash */
        ::view-transition-old(root),
        ::view-transition-new(root) {
            animation: none;
            mix-blend-mode: normal;
        }
        
        /* Grupo da logo mantém posição durante transição */
        ::view-transition-group(auth-logo) {
            animation-duration: 0.35s;
            animation-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        /* Título e Formulário - apenas crossfade suave, sem movimento */
        ::view-transition-old(auth-title),
        ::view-transition-old(auth-form) {
            animation: simpleFadeOut 0.25s ease-out forwards;
        }
        
        ::view-transition-new(auth-title),
        ::view-transition-new(auth-form) {
            animation: simpleFadeIn 0.35s ease-out forwards;
        }
        
        @keyframes simpleFadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
        
        @keyframes simpleFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* === CORREÇÕES GERAIS DO SPA (SCROLL & LAYOUT) === */
        html, body {
            height: 100%;
            overflow-y: auto !important;
            overflow-x: hidden;
            position: static !important;
            -webkit-overflow-scrolling: touch;
            background-color: var(--bg-color, #121212);
            margin: 0;
            padding: 0;
            /* Esconder scrollbar */
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* IE/Edge */
        }
        
        /* Esconder scrollbar no Chrome/Safari */
        html::-webkit-scrollbar,
        body::-webkit-scrollbar {
            display: none;
        }

        /* Container Padrão (Dashboard, etc): Scrollável e ocupa altura do conteúdo */
        #app-container {
            width: 100%;
            height: 100vh;
            position: relative;
            padding-bottom: 60px; /* Espaço do menu - igual à altura do bottom-nav */
            z-index: 1;
            box-sizing: border-box;
            /* SCROLL - Essencial! */
            overflow-y: scroll !important;
            overflow-x: hidden;
            -webkit-overflow-scrolling: touch;
            /* TOUCH - Crítico para mobile */
            touch-action: pan-y !important;
            overscroll-behavior: contain;
            /* Garantir que não há espaço extra no final */
            margin-bottom: 0;
            /* Esconder scrollbar */
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* IE/Edge */
        }
        
        /* Esconder scrollbar no Chrome/Safari */
        #app-container::-webkit-scrollbar {
            display: none;
        }
        
        /* Remover espaço extra apenas da última section.dashboard-grid na main_app */
        #app-container .page-root section.dashboard-grid:last-of-type {
            margin-bottom: 0 !important;
            padding-bottom: 0 !important;
        }
        
        /* Remover espaço extra do último card dentro da última dashboard-grid */
        #app-container .page-root section.dashboard-grid:last-of-type > .card-challenges:last-child {
            margin-bottom: 0 !important;
        }

        /* Classe de Controle: Quando o menu some, remove o buraco no final */
        #bottom-nav-container.hidden ~ #app-container, 
        body.auth-mode #app-container {
            padding-bottom: 0 !important;
        }
        
        /* Remover padding-bottom dos .app-container dentro dos fragments 
           O #app-container principal já cuida do espaçamento do menu */
        #app-container .page-root .app-container {
            padding-bottom: 0 !important;
            margin-bottom: 0 !important;
            /* IMPORTANTE: Não definir altura - deixar o conteúdo determinar */
            height: auto !important;
            min-height: auto !important;
            overflow: visible !important;
        }
        
        /* Page root precisa permitir que o conteúdo flua */
        #app-container .page-root {
            margin-bottom: 0 !important;
            /* NÃO remover padding-bottom aqui - deixar os grids definirem */
            overflow: visible !important;
            min-height: auto !important;
        }
        
        /* Esconder scrollbar em todos os elementos com scroll */
        * {
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* IE/Edge */
        }
        
        *::-webkit-scrollbar {
            display: none; /* Chrome/Safari */
        }
        
        .hidden { display: none !important; }
        .page-loading { opacity: 0; }
        .page-loaded { opacity: 1; }
        
        /* Otimização de camada para evitar flick */
        #app-container {
            will-change: scroll-position;
            /* REMOVIDO contain: layout style - quebrava scroll em alguns casos */
        }

        /* === ESTILO DO MENU (GLASSMORPHISM) === */
        #bottom-nav-container {
            position: fixed !important;
            bottom: 0 !important;
            left: 0 !important;
            right: 0 !important;
            width: 100% !important;
            z-index: 1000 !important;
            will-change: transform;
            transform: translateY(0);
            -webkit-transform: translateY(0);
            /* Transição FLUIDA */
            transition: transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94) !important;
            -webkit-transition: -webkit-transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94) !important;
        }
        
        /* Auto-hide: quando scrollar para baixo */
        #bottom-nav-container.nav-hidden {
            transform: translateY(100%) !important;
            -webkit-transform: translateY(100%) !important;
        }

        .bottom-nav {
            /* CRÍTICO: Remover position fixed do filho - só o container deve ser fixed */
            position: relative !important;
            /* Herdar transição */
            transition: transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94) !important;
            display: flex !important;
            justify-content: space-around !important;
            align-items: center !important;
            width: 100% !important;
            max-width: none !important;
            margin: 0 !important;
            background: rgba(24, 24, 24, 0.92) !important;
            backdrop-filter: blur(10px) !important;
            -webkit-backdrop-filter: blur(10px) !important;
            border-top: 1px solid var(--glass-border, rgba(255, 255, 255, 0.1)) !important;
            padding-top: 12px !important;
            padding-bottom: calc(12px + env(safe-area-inset-bottom, 0px)) !important;
            padding-left: calc(10px + env(safe-area-inset-left, 0px)) !important;
            padding-right: calc(10px + env(safe-area-inset-right, 0px)) !important;
            min-height: calc(60px + env(safe-area-inset-bottom, 0px)) !important;
            visibility: visible !important;
            opacity: 1 !important;
        }

        .nav-item {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            color: var(--text-secondary, #8E8E93);
            transition: color 0.2s ease;
            -webkit-tap-highlight-color: transparent;
        }

        .nav-item i { font-size: 1.5rem; }
        .nav-item.active { color: var(--accent-orange, #ff6b00) !important; }

        /* === CORREÇÃO DE LOGIN E REGISTRO (MODO AUTH) === */
        
        /* Padrão: Bloco normal (Dashboard) */
        .page-root {
            display: block;
            width: 100%;
            height: auto;
            margin: 0;
            padding: 0;
        }

        /* Modo Auth: Centraliza tudo na tela */
        body.auth-mode .page-root {
            display: flex !important;
            flex-direction: column !important;
            justify-content: center !important;
            align-items: center !important;
            min-height: 100vh !important;
            width: 100% !important;
        }

        /* Ajustes dos containers internos de login */
        .login-container, .register-container, .auth-container {
            width: 100%;
            max-width: 350px;
            padding: 20px;
            margin: 0 auto;
        }

        /* Ícones e Inputs (FontAwesome) */
        .form-group, .input-group {
            position: relative !important;
            margin-bottom: 15px;
            width: 100%;
        }

        .form-group i, .input-group i, .input-icon {
            position: absolute !important;
            left: 15px !important;
            top: 50% !important;
            transform: translateY(-50%) !important;
            z-index: 10 !important;
            font-style: normal !important; 
            font-family: "Font Awesome 5 Free" !important;
            font-weight: 900 !important;
            font-size: 16px !important;
            color: #888 !important;
            pointer-events: none;
            display: block !important;
        }

        .form-group input, .input-group input {
            padding-left: 45px !important;
            height: 50px !important;
            width: 100% !important;
            box-sizing: border-box !important;
        }
        
        /* === CORREÇÃO DE MODAIS === */
        /* Garantir que modais funcionem corretamente no SPA */
        /* Modais devem estar acima de tudo quando visíveis */
        .modal {
            z-index: 9999 !important;
            position: fixed !important;
        }
        
        /* Quando visível, garantir interatividade */
        .modal.is-visible {
            pointer-events: auto !important;
        }
        
        /* Conteúdo do modal sempre interativo quando modal está visível */
        .modal.is-visible .modal-content {
            pointer-events: auto !important;
            position: relative !important;
            z-index: 10000 !important;
        }
        
        /* Garantir que app-container não bloqueie modais */
        #app-container {
            z-index: 1 !important;
        }
        
        /* Bottom nav deve ficar abaixo dos modais */
        #bottom-nav-container {
            z-index: 1000 !important;
        }

        /* Logo */
        body.auth-mode .page-root img {
            max-width: 150px;
            margin-bottom: 30px;
            display: block;
        }
    </style>
    <script>
        // Esconder menu IMEDIATAMENTE se for página de auth (antes do DOM carregar)
        (function() {
            var path = window.location.pathname;
            var isAuthPage = path.includes('login') || path.includes('cadastro') || path.includes('register') || path.includes('bem-vindo') || path.includes('onboarding');
            if (isAuthPage) {
                document.write('<style>#bottom-nav-container{display:none!important}</style>');
            }
        })();
    </script>
</head>
<body>
    <div id="app-container"></div>
    
    <div id="bottom-nav-container">
        <nav class="bottom-nav">
            <a href="/main_app.html" class="nav-item" data-page="home">
                <i class="fas fa-home"></i>
            </a>
            <a href="/progress.html" class="nav-item" data-page="stats">
                <i class="fas fa-chart-line"></i>
            </a>
            <a href="/diary.html" class="nav-item" data-page="diary">
                <i class="fas fa-book"></i>
            </a>
            <a href="/explore_recipes.html" class="nav-item" data-page="explore">
                <i class="fas fa-utensils"></i>
            </a>
            <a href="/more_options.html" class="nav-item" data-page="settings">
                <i class="fas fa-cog"></i>
            </a>
        </nav>
    </div>
    
    <script src="/assets/js/common.js"></script>
    <script src="/assets/js/config.js"></script>
    <script src="/assets/js/auth.js"></script>
    <script type="module" src="/assets/js/toast-helper.js"></script> 

    <script src="/assets/js/raphael.min.js"></script>
    <script src="/assets/js/justgage.min.js"></script>
    <script src="/assets/js/time-picker.js"></script>

    <script src="/assets/js/routine_circular.js"></script>
    <script src="/assets/js/banner-carousel.js"></script>
    <!-- Import map para resolver módulos Scandit -->
    <script type="importmap">
    {
        "imports": {
            "@scandit/web-datacapture-core": "https://cdn.jsdelivr.net/npm/@scandit/web-datacapture-core@7.3.0/+esm",
            "@scandit/web-datacapture-barcode": "https://cdn.jsdelivr.net/npm/@scandit/web-datacapture-barcode@7.3.0/+esm"
        }
    }
    </script>
    <script type="module" src="/assets/js/barcode_scanner.js"></script>
    
    <script src="/assets/js/bottom-nav.js"></script>
    <script src="/assets/js/spa-fixes.js"></script>

    <script src="/assets/js/router.js" defer></script>
</body>
</html>