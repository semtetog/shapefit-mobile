<div class="app-container">
    <!-- Header -->
    <div class="page-header">
        <a href="#" id="back-btn" class="back-btn">
            <i class="fas fa-chevron-left"></i>
        </a>
        <h1 class="page-title">Adicionar Refeição</h1>
        <div></div>
    </div>

    <!-- Configuração da refeição -->
    <div class="meal-setup">
        <div class="form-group">
            <label>Data</label>
            <input type="date" class="form-control" id="meal-date" value="">
        </div>
        <div class="form-group">
            <label>Tipo de Refeição</label>
            <select class="form-control" id="meal-type">
                <option value="">Carregando...</option>
            </select>
        </div>
    </div>

    <!-- Itens pendentes para salvar -->
    <div class="pending-section">
        <div class="pending-header">
            <h2 class="section-title">Itens selecionados</h2>
        </div>
        <div id="pending-feedback" class="pending-feedback"></div>
        <div id="pending-list" class="pending-empty">
            Nenhum item selecionado. Busque um alimento ou receita para começar.
        </div>
        <div id="pending-totals" class="pending-totals" style="display:none;"></div>
        <div class="pending-actions">
            <button id="save-all-btn" class="btn-save-all" disabled>
                <i class="fas fa-save"></i>
                Salvar no Diário
            </button>
        </div>
    </div>

    <!-- Busca de receitas e alimentos -->
    <div class="search-section">
        <div class="search-tabs">
            <button class="tab-btn active" data-tab="recipes">Receitas</button>
            <button class="tab-btn" data-tab="foods">Alimentos</button>
        </div>
        <div class="search-input-wrapper">
            <input type="text" class="search-input" id="search-input" placeholder="Buscar receitas e alimentos...">
            <button class="search-btn" onclick="performSearch()">
                <i class="fas fa-search"></i>
            </button>
        </div>
        <div class="search-results" id="search-results" style="display: none;"></div>
        
        <!-- Novos botões para criar alimentos -->
        <div class="custom-food-actions">
            <a href="scan_barcode.html" class="custom-food-btn">
                <i class="fas fa-barcode"></i>
                <span>Escanear Código de Barras</span>
            </a>
            <a href="create_custom_food.html" class="custom-food-btn">
                <i class="fas fa-plus-circle"></i>
                <span>Cadastrar Alimento Manual</span>
            </a>
        </div>
    </div>

    <!-- Receitas favoritas -->
    <div class="recipes-section" id="favorite-recipes-section" style="display: none;">
        <h2 class="section-title">Favoritas</h2>
        <div class="recipes-grid" id="favorite-recipes"></div>
    </div>

    <!-- Receitas recentes -->
    <div class="recipes-section" id="recent-recipes-section" style="display: none;">
        <h2 class="section-title">Recentes</h2>
        <div class="recipes-grid" id="recent-recipes"></div>
    </div>

    <!-- Estado vazio se não há receitas -->
    <div class="empty-state" id="empty-recipes-state" style="display: none;">
        <i class="fas fa-utensils"></i>
        <h3>Nenhuma receita encontrada</h3>
        <p>Explore receitas favoritas ou adicione novas receitas</p>
    </div>
</div>

<!-- Modal de configuração -->
<div class="recipe-modal" id="recipe-modal">
    <div class="modal-content">
        <div class="modal-header">
            <div class="modal-drag-indicator"></div>
            <h2 class="modal-title" id="modal-recipe-name">Nome da Receita</h2>
        </div>
        <div class="modal-body">
            <div class="form-section">
                <label for="custom_meal_name" class="portion-label">Nome da Refeição</label>
                <input type="text" id="custom_meal_name" class="portion-input" placeholder="Ex: Arroz com frango grelhado">
            </div>
            
            <div class="form-section">
                <label for="meal_time" class="portion-label">Horário da Refeição</label>
                <input type="time" id="meal_time" class="portion-input" value="">
            </div>
            
            <div class="portion-section">
                <label class="portion-label" id="quantity-label">Quantidade</label>
                <div class="quantity-input-group">
                    <input type="number" id="quantity" class="quantity-input" value="1" min="0.1" step="0.1" placeholder="1">
                    <select id="unit-select" class="unit-select" style="display: none;">
                        <option value="">Carregando...</option>
                    </select>
                </div>
                <div class="quantity-info" id="quantity-info" style="display: none;">
                    <small class="text-muted">
                        <span id="conversion-info"></span>
                    </small>
                </div>
            </div>
    
            <div class="nutrition-display">
                <div class="nutrition-grid">
                    <div class="nutrition-item">
                        <div class="nutrition-item-label">Calorias</div>
                        <div class="nutrition-item-value" id="total-kcal">0 <span class="nutrition-item-unit">kcal</span></div>
                    </div>
                    <div class="nutrition-item">
                        <div class="nutrition-item-label">Proteínas</div>
                        <div class="nutrition-item-value" id="total-protein">0 <span class="nutrition-item-unit">g</span></div>
                    </div>
                    <div class="nutrition-item">
                        <div class="nutrition-item-label">Carboidratos</div>
                        <div class="nutrition-item-value" id="total-carbs">0 <span class="nutrition-item-unit">g</span></div>
                    </div>
                    <div class="nutrition-item">
                        <div class="nutrition-item-label">Gorduras</div>
                        <div class="nutrition-item-value" id="total-fat">0 <span class="nutrition-item-unit">g</span></div>
                    </div>
                </div>
            </div>
            <input type="hidden" id="selected-recipe-id">
        </div>
        <div class="modal-footer">
            <button class="btn-add-meal" onclick="confirmMeal()">
                <i class="fas fa-plus"></i>
                Adicionar à lista
            </button>
        </div>
    </div>
</div>

