<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <script src="./www-config.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover, shrink-to-fit=no">
    
    <!-- PWA Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ShapeFIT">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="ShapeFIT">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta name="apple-mobile-web-app-orientations" content="portrait">
    <meta name="theme-color" content="transparent">
    <meta name="msapplication-navbutton-color" content="transparent">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="./manifest.json">
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="./assets/images/app-icon.png">
    
    <!-- Script Critical - Define altura real do viewport -->
    <script>
        function setRealViewportHeight() { 
            const vh = window.innerHeight * 0.01; 
            document.documentElement.style.setProperty('--vh', `${vh}px`); 
        }
        setRealViewportHeight();
        window.addEventListener('resize', setRealViewportHeight);
        window.addEventListener('orientationchange', function() {
            setTimeout(setRealViewportHeight, 100);
        });
    </script>
    
    <title>Ranking - ShapeFIT</title>
    
    <!-- CSS Principal -->
    <link rel="stylesheet" href="./assets/css/style.css">
    
    <style>
:root {
    --bg-color: #121212;
    --surface-color: #1E1E1E;
    --border-color: #2E2E2E;
    --text-primary: #FFFFFF;
    --text-secondary: #A0A0A0;
    --accent-orange: #FF6B00;
    --glass-bg: rgba(255, 255, 255, 0.03);
    --glass-border: rgba(255, 255, 255, 0.1);
    --primary-orange-gradient: linear-gradient(135deg, #FF6B00, #FF8533);
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    background: var(--bg-color);
    color: var(--text-primary);
    min-height: 100vh;
    /* padding-bottom removido - usa o do .app-container global */
}

/* Removido - usa o CSS global de _global.css */

/* Layout baseado no more_options */
.ranking-page-grid {
    display: flex;
    flex-direction: column;
    gap: 20px;
    padding: 0 8px 20px 8px; /* Removido padding-top - usa o do app-container */
}

.header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:20px; /* Reduzido de 24px */
    padding: 0 12px;
    margin-top: 0; /* Garantir que n√£o h√° margem extra no topo */
}
.header-actions{
    display:flex;
    align-items:center;
    gap:.75rem
}
.points-counter-badge{
    display:flex;
    align-items:center;
    gap:8px;
    height:44px;
    padding:0 16px;
    border-radius:22px;
    background-color:var(--surface-color);
    border:1px solid var(--border-color);
    color:var(--text-primary);
    text-decoration:none;
    transition:all .2s ease
}
.points-counter-badge:hover{
    border-color:var(--accent-orange)
}
.points-counter-badge i{
    color:var(--accent-orange);
    font-size:1rem
}
.points-counter-badge span{
    font-weight:600;
    font-size:1rem
}

.page-title {
    font-size: 2rem;
    font-weight: 700;
    color: var(--text-primary);
    margin: 0;
    display: flex;
    align-items: center;
    gap: 12px;
}

.page-title i {
    color: var(--accent-orange);
    font-size: 1.8rem;
}

/* P√≥dio sem background geral */
.podium-section {
    margin-bottom: 0; /* Removido - o gap do grid j√° cuida */
    margin-top: 0; /* Garantir que n√£o h√° margem extra no topo */
}

.podium-container {
    display: flex;
    justify-content: center;
    align-items: flex-end;
    gap: 20px;
    margin-bottom: 20px; /* Reduzido de 32px */
    padding: 0; /* Removido padding - o gap do grid j√° cuida do espa√ßamento */
}

.podium-place {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    position: relative;
}

.podium-place.first {
    order: 2;
    transform: scale(1.1);
}

.podium-place.second {
    order: 1;
}

.podium-place.third {
    order: 3;
}

.player-avatar-large {
    width: 64px;
    height: 64px;
    border-radius: 50%;
    background-color: rgba(255,255,255,0.05);
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    border: 2px solid var(--accent-orange);
    margin-bottom: 12px;
}

.player-avatar-large img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.player-avatar-large i {
    color: var(--accent-orange);
    font-size: 1.8rem;
}

.podium-place.first .player-avatar-large {
    width: 80px;
    height: 80px;
    border-width: 3px;
}

.podium-place.first .player-avatar-large i {
    font-size: 2.2rem;
}

.rank-badge {
    position: absolute;
    top: -8px;
    right: -8px;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 0.9rem;
    color: white;
}

.podium-place.first .rank-badge {
    background: linear-gradient(135deg, #ffd700, #ffed4e);
    color: #333;
    width: 36px;
    height: 36px;
    font-size: 1rem;
}

.podium-place.second .rank-badge {
    background: linear-gradient(135deg, #c0c0c0, #e8e8e8);
    color: #333;
}

.podium-place.third .rank-badge {
    background: linear-gradient(135deg, #cd7f32, #daa520);
    color: white;
}

.podium-name {
    font-size: 1rem;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 4px;
}

.podium-level {
    font-size: 0.85rem;
    color: var(--accent-orange);
    font-weight: 500;
    margin-bottom: 4px;
}

.podium-points {
    font-size: 0.8rem;
    color: var(--text-secondary);
    font-weight: 500;
}

/* Lista de ranking com componentes coloridos, backgrounds sem satura√ß√£o */
.ranking-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.ranking-item {
    display: grid;
    grid-template-columns: 32px 1fr auto;
    align-items: center;
    padding: 18px 20px;
    margin-bottom: 8px;
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.08);
    border-radius: 20px;
    transition: all 0.2s ease;
    width: 100%;
    gap: 16px;
}

/* N√∫meros perfeitamente alinhados */
.rank-position {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
    font-size: 0.9rem;
    font-weight: 600;
    color: rgba(255, 255, 255, 0.6);
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    flex-shrink: 0;
    align-self: center;
    margin: auto 0;
}

.ranking-item.current-user .rank-position {
    color: var(--accent-orange);
    background: rgba(255, 140, 0, 0.15);
}

.ranking-item:hover {
    background: rgba(255, 255, 255, 0.05);
    border-color: rgba(255, 255, 255, 0.1);
    transform: translateY(-2px);
}

.ranking-item.current-user {
    background: rgba(255, 107, 0, 0.1);
    border-color: var(--accent-orange);
}

.player-content {
    display: flex;
    align-items: center;
    gap: 12px;
    min-width: 0;
}

.player-avatar {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    background-color: rgba(255,255,255,0.05);
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    border: 2px solid var(--accent-orange);
    flex-shrink: 0;
}

.player-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.player-avatar i {
    color: var(--accent-orange);
    font-size: 1.2rem;
}

.player-info {
    display: flex;
    flex-direction: column;
    gap: 2px;
    min-width: 0;
    flex: 1;
    max-width: calc(100% - 44px - 12px);
}

.player-name {
    font-size: 1rem;
    font-weight: 600;
    color: var(--text-primary);
    margin: 0;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 100%;
}

.player-level {
    font-size: 0.8rem;
    color: var(--accent-orange);
    font-weight: 500;
    margin: 0;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 100%;
}

.player-points {
    font-size: 0.9rem;
    font-weight: 600;
    color: var(--text-secondary);
    text-align: right;
    flex-shrink: 0;
    white-space: nowrap;
}

.ranking-item.current-user .player-points {
    color: var(--accent-orange);
}

/* Bot√£o Carregar Mais */
.load-more-container {
    display: flex;
    justify-content: center;
    margin-top: 20px;
    padding: 0 20px;
}

.load-more-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 12px 24px;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 16px;
    color: var(--text-primary);
    font-size: 0.9rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
    text-decoration: none;
    font-family: inherit;
}

.load-more-btn:hover {
    background: rgba(255, 255, 255, 0.08);
    border-color: rgba(255, 255, 255, 0.2);
    transform: translateY(-2px);
}

.load-more-btn i {
    font-size: 0.8rem;
    transition: transform 0.3s ease;
}

.load-more-btn:hover i {
    transform: translateY(2px);
}

.load-more-btn .users-count {
    color: var(--text-secondary);
    font-size: 0.8rem;
    font-weight: 400;
}

.load-more-btn.loading {
    opacity: 0.7;
    cursor: not-allowed;
}

.load-more-btn.loading i {
    animation: spin 1s linear infinite;
}

@keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

/* Responsividade */
@media (max-width: 768px) {
    .ranking-page-grid {
        padding: 20px 6px 20px 6px;
    }
    
    .podium-container {
        gap: 16px;
    }
    
    .player-avatar-large {
        width: 56px;
        height: 56px;
    }
    
    .podium-place.first .player-avatar-large {
        width: 72px;
        height: 72px;
    }
    
    .ranking-item {
        padding: 16px 18px;
        gap: 12px;
    }
    
    .rank-position {
        width: 28px;
        height: 28px;
        font-size: 0.8rem;
        border-radius: 10px;
        align-self: center;
        margin: auto 0;
    }
    
    .player-avatar {
        width: 40px;
        height: 40px;
    }
    
    .player-info {
        max-width: calc(100% - 40px - 12px);
    }
    
    .player-name {
        font-size: 0.95rem;
    }
    
    .player-level {
        font-size: 0.75rem;
    }
    
    .player-points {
        font-size: 0.85rem;
    }
}
    </style>
</head>
<body>
    <div class="app-container">
        <header class="header">
    <script src="./www-config.js"></script>
            <h1 class="page-title">
                <i class="fas fa-trophy"></i>
                Ranking
            </h1>
            
            <div class="header-actions">
                <a href="./points_history.html" class="points-counter-badge" id="points-badge">
                    <i class="fas fa-star"></i>
                    <span id="user-points-display">0</span>
                </a>
            </div>
        </header>

        <section class="ranking-page-grid">
            <!-- P√≥dio -->
            <div class="podium-section">
                <div class="podium-container" id="podium-container">
                    <!-- Ser√° preenchido via JavaScript -->
                </div>
            </div>
            
            <!-- Lista de Ranking -->
            <ul class="ranking-list" id="ranking-list">
                <!-- Ser√° preenchido via JavaScript -->
            </ul>
            
            <!-- Bot√£o Carregar Mais -->
            <div class="load-more-container" id="load-more-container" style="display: none;">
                <button id="load-more-btn" class="load-more-btn">
                    <i class="fas fa-chevron-down"></i>
                    Carregar Mais
                    <span class="users-count"></span>
                </button>
            </div>
        </section>
    </div>

    <!-- Auth Script -->
    <script>
        // Definir BASE_APP_URL antes de carregar auth.js
        // BASE_APP_URL j√° foi definido pelo www-config.js
        if (!window.BASE_APP_URL) { window.BASE_APP_URL = window.location.origin + window.location.pathname.split('/').slice(0, -1).join('/'); } if (window.BASE_APP_URL && window.BASE_APP_URL.endsWith('/')) {
            window.BASE_APP_URL = window.BASE_APP_URL.slice(0, -1);
        }
    </script>
    <script src="./assets/js/auth.js"></script>
    <script src="./assets/js/common.js"></script>
    
    <!-- √çcones -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    
    <!-- Bottom Navigation (via JavaScript - funciona como include) -->
    <script>
        const bottomNavScript = document.createElement('script');
        bottomNavScript.src = './assets/js/bottom-nav.js?v=' + Date.now();
        document.head.appendChild(bottomNavScript);
    </script>
    
    <script>
        // ========================================
        // CARREGAR E RENDERIZAR RANKING
        // ========================================
        (async function() {
            const BASE_URL = window.BASE_APP_URL;
            let currentLimit = 15;
            let totalUsers = 0;
            let currentUserId = null;
            
            // Verificar autentica√ß√£o
            const authenticated = await requireAuth();
            if (!authenticated) {
                return;
            }
            
            // Fun√ß√£o para renderizar foto de perfil (igual ao PHP: getUserProfileImageHtml)
            function renderUserAvatar(playerData, size = 'normal') {
                if (!playerData) return '';
                
                const isLarge = size === 'large';
                const classSize = isLarge ? 'player-avatar-large' : 'player-avatar';
                
                if (playerData.image_url || playerData.profile_image_filename) {
                    const imageUrl = playerData.image_url || `${BASE_URL}/assets/images/users/${playerData.profile_image_filename}`;
                    const thumbUrl = playerData.thumb_url || (playerData.profile_image_filename ? `${BASE_URL}/assets/images/users/thumb_${playerData.profile_image_filename}` : null);
                    
                    // Tentar imagem original primeiro, depois thumbnail, depois √≠cone (igual ao PHP)
                    if (thumbUrl) {
                        return `
                            <div class="${classSize}">
                                <img src="${imageUrl}" alt="Foto de Perfil" onerror="this.onerror=null; this.src='${thumbUrl}'; this.onerror=function(){this.style.display='none'; this.nextElementSibling.style.display='flex';}">
                                <i class="fas fa-user" style="display:none;"></i>
                            </div>
                        `;
                    } else {
                        return `
                            <div class="${classSize}">
                                <img src="${imageUrl}" alt="Foto de Perfil" onerror="this.onerror=null; this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                <i class="fas fa-user" style="display:none;"></i>
                            </div>
                        `;
                    }
                }
                
                // Se n√£o tem foto, mostrar √≠cone (igual ao PHP)
                return `<div class="${classSize}"><i class="fas fa-user"></i></div>`;
            }
            
            // Fun√ß√£o para formatar n√∫mero
            function formatNumber(num) {
                return new Intl.NumberFormat('pt-BR').format(num);
            }
            
            // Fun√ß√£o para renderizar p√≥dio
            function renderPodium(podium) {
                const container = document.getElementById('podium-container');
                if (!container) return;
                
                if (!podium || podium.length === 0) {
                    container.innerHTML = '<p style="text-align: center; color: var(--text-secondary);">Nenhum usu√°rio no ranking ainda.</p>';
                    return;
                }
                
                // Garantir que temos pelo menos 3 posi√ß√µes (preencher com null se necess√°rio)
                const first = podium[0] || null;
                const second = podium[1] || null;
                const third = podium[2] || null;
                
                let html = '';
                
                // 2¬∫ Lugar
                html += `
                    <div class="podium-place second">
                        ${second ? renderUserAvatar(second, 'large') : '<div class="player-avatar-large"><i class="fas fa-user"></i></div>'}
                        <div class="rank-badge">2</div>
                        <span class="podium-name">${second ? escapeHtml(second.name.split(' ')[0]) : '-'}</span>
                        <span class="podium-level">${second ? escapeHtml(second.level) : '-'}</span>
                        <span class="podium-points">${second ? formatNumber(second.points) + ' pts' : '-'}</span>
                    </div>
                `;
                
                // 1¬∫ Lugar
                html += `
                    <div class="podium-place first">
                        ${first ? renderUserAvatar(first, 'large') : '<div class="player-avatar-large"><i class="fas fa-user"></i></div>'}
                        <div class="rank-badge"><i class="fas fa-crown"></i></div>
                        <span class="podium-name">${first ? escapeHtml(first.name.split(' ')[0]) : '-'}</span>
                        <span class="podium-level">${first ? escapeHtml(first.level) : '-'}</span>
                        <span class="podium-points">${first ? formatNumber(first.points) + ' pts' : '-'}</span>
                    </div>
                `;
                
                // 3¬∫ Lugar
                html += `
                    <div class="podium-place third">
                        ${third ? renderUserAvatar(third, 'large') : '<div class="player-avatar-large"><i class="fas fa-user"></i></div>'}
                        <div class="rank-badge">3</div>
                        <span class="podium-name">${third ? escapeHtml(third.name.split(' ')[0]) : '-'}</span>
                        <span class="podium-level">${third ? escapeHtml(third.level) : '-'}</span>
                        <span class="podium-points">${third ? formatNumber(third.points) + ' pts' : '-'}</span>
                    </div>
                `;
                
                container.innerHTML = html;
            }
            
            // Fun√ß√£o para renderizar lista
            function renderList(list, currentUserId) {
                const listEl = document.getElementById('ranking-list');
                if (!listEl) return;
                
                if (!list || list.length === 0) {
                    listEl.innerHTML = '<li style="text-align: center; padding: 40px; color: var(--text-secondary);">Nenhum usu√°rio na lista.</li>';
                    return;
                }
                
                let html = '';
                list.forEach(player => {
                    const isCurrentUser = player.id == currentUserId;
                    html += `
                        <li class="ranking-item ${isCurrentUser ? 'current-user' : ''}">
                            <div class="rank-position">${player.user_rank}</div>
                            <div class="player-content">
                                ${renderUserAvatar(player)}
                                <div class="player-info">
                                    <h3 class="player-name">${escapeHtml(player.name)}</h3>
                                    <p class="player-level">${escapeHtml(player.level)}</p>
                                </div>
                            </div>
                            <span class="player-points">${formatNumber(player.points)} pts</span>
                        </li>
                    `;
                });
                
                listEl.innerHTML = html;
            }
            
            // Fun√ß√£o para carregar dados do ranking
            async function loadRankingData(limit = 15) {
                try {
                    const response = await authenticatedFetch(`${BASE_URL}/api/get_ranking_data.php?limit=${limit}`);
                    if (!response) {
                        console.error('‚ùå [Ranking] Resposta vazia da API');
                        return null;
                    }
                    
                    // Clonar resposta para poder ler como texto (debug) e JSON
                    const responseClone = response.clone();
                    
                    // Verificar status da resposta
                    if (!response.ok) {
                        console.error('‚ùå [Ranking] Erro HTTP:', response.status, response.statusText);
                        const text = await responseClone.text();
                        console.error('‚ùå [Ranking] Resposta:', text);
                        return null;
                    }
                    
                    // Ler resposta como texto primeiro para debug
                    const text = await responseClone.text();
                    console.log('üì• [Ranking] Resposta da API (primeiros 500 chars):', text.substring(0, 500));
                    
                    // Tentar parsear JSON
                    let result;
                    try {
                        result = JSON.parse(text);
                    } catch (parseError) {
                        console.error('‚ùå [Ranking] Erro ao parsear JSON:', parseError);
                        console.error('‚ùå [Ranking] Texto completo:', text);
                        return null;
                    }
                    
                    if (!result.success) {
                        console.error('‚ùå [Ranking] API retornou erro:', result.message || result.error);
                        throw new Error(result.message || 'Erro ao carregar ranking');
                    }
                    
                    return result.data;
                } catch (error) {
                    console.error('‚ùå [Ranking] Erro ao carregar ranking:', error);
                    return null;
                }
            }
            
            // Carregar dados iniciais
            const data = await loadRankingData(currentLimit);
            
            if (data) {
                currentUserId = data.current_user?.id || null;
                totalUsers = data.total_users || 0;
                currentLimit = data.current_limit || 15;
                
                // Atualizar pontos do usu√°rio
                const pointsDisplay = document.getElementById('user-points-display');
                if (pointsDisplay) {
                    pointsDisplay.textContent = formatNumber(data.user_points || 0);
                }
                
                // Renderizar p√≥dio
                renderPodium(data.podium || []);
                
                // Renderizar lista
                renderList(data.list || [], currentUserId);
                
                // Mostrar bot√£o "Carregar Mais" se houver mais usu√°rios
                const loadMoreContainer = document.getElementById('load-more-container');
                const loadMoreBtn = document.getElementById('load-more-btn');
                
                if (data.has_more_users && loadMoreContainer && loadMoreBtn) {
                    loadMoreContainer.style.display = 'flex';
                    const remaining = totalUsers - currentLimit;
                    loadMoreBtn.querySelector('.users-count').textContent = `(${remaining} restantes)`;
                    
                    loadMoreBtn.addEventListener('click', async function(e) {
                        e.preventDefault();
                        
                        if (this.classList.contains('loading')) return;
                        
                        this.classList.add('loading');
                        this.innerHTML = '<i class="fas fa-spinner"></i>Carregando...';
                        
                        const newLimit = Math.min(currentLimit + 15, totalUsers);
                        const newData = await loadRankingData(newLimit);
                        
                        if (newData) {
                            currentLimit = newData.current_limit || newLimit;
                            
                            // Adicionar novos usu√°rios √† lista (ap√≥s os 3 primeiros do p√≥dio)
                            const newList = newData.list || [];
                            const currentList = document.getElementById('ranking-list');
                            
                            // Obter ranks j√° existentes na lista
                            const existingRanks = new Set();
                            Array.from(currentList.children).forEach(li => {
                                const rankPos = li.querySelector('.rank-position');
                                if (rankPos) {
                                    existingRanks.add(parseInt(rankPos.textContent));
                                }
                            });
                            
                            // Adicionar apenas usu√°rios novos (que n√£o est√£o na lista)
                            newList.forEach(player => {
                                if (!existingRanks.has(player.user_rank)) {
                                    const isCurrentUser = player.id == currentUserId;
                                    const li = document.createElement('li');
                                    li.className = `ranking-item ${isCurrentUser ? 'current-user' : ''}`;
                                    li.innerHTML = `
                                        <div class="rank-position">${player.user_rank}</div>
                                        <div class="player-content">
                                            ${renderUserAvatar(player)}
                                            <div class="player-info">
                                                <h3 class="player-name">${escapeHtml(player.name)}</h3>
                                                <p class="player-level">${escapeHtml(player.level)}</p>
                                            </div>
                                        </div>
                                        <span class="player-points">${formatNumber(player.points)} pts</span>
                                    `;
                                    currentList.appendChild(li);
                                    existingRanks.add(player.user_rank);
                                }
                            });
                            
                            // Atualizar ou remover bot√£o
                            if (newData.has_more_users) {
                                const remaining = totalUsers - currentLimit;
                                this.classList.remove('loading');
                                this.innerHTML = `
                                    <i class="fas fa-chevron-down"></i>
                                    Carregar Mais
                                    <span class="users-count">(${remaining} restantes)</span>
                                `;
                            } else {
                                loadMoreContainer.style.display = 'none';
                            }
                        } else {
                            this.classList.remove('loading');
                            this.innerHTML = `
                                <i class="fas fa-chevron-down"></i>
                                Carregar Mais
                                <span class="users-count">(${totalUsers - currentLimit} restantes)</span>
                            `;
                            alert('Erro ao carregar mais usu√°rios. Tente novamente.');
                        }
                    });
                } else if (loadMoreContainer) {
                    loadMoreContainer.style.display = 'none';
                }
            } else {
                // Mostrar erro
                const rankingList = document.getElementById('ranking-list');
                if (rankingList) {
                    rankingList.innerHTML = '<li style="text-align: center; padding: 40px; color: var(--text-secondary);">Erro ao carregar ranking. Tente novamente.</li>';
                }
            }
        })();
    </script>
</body>
</html>

